Laravel Notes - notes.txt

=============
meta notes
	- get spell check to work on VS Code
		- https://visualstudiogallery.msdn.microsoft.com/a23de100-31a1-405c-b4b7-d6be40c3dfff
		- https://code.visualstudio.com/Docs/extensions/example-hello-world
=============

Links
	- Software site
		- https://laravel.com/docs/5.0
	- Best instructions on installing Laravel and all software it needs
		- http://tutsnare.com/how-to-install-laravel-on-ubuntu-lamp/

	- Other useful links:
	-	https://getcomposer.org/download/
	-	https://community.c9.io/t/getting-started-with-laravel/1608
	-	https://www.digitalocean.com/community/tutorials/how-to-install-and-use-composer-on-ubuntu-14-04

Installing Laravel
	# download installer
		- composer global require "laravel/installer=~1.1"
	#setting up path
		- export PATH="~/.composer/vendor/bin:$PATH" 
	# change dir where to install
		- cd /var/www/html/
	# download and installing
		- laravel new laravelnew
	# giving permission
		- chmod -R 777 laravelnew

FAQ
	- Where are these files?
		- You can quickly search for a file with CTRL + p (in Sublime & VS Code)
		- Routes.php				app/Http/Requests/routes.php
		- Template foo.blade.php	resources/views/foo.blade.php
		- Contorlers				app/Http/Controlers/FooControllerName.php
		- CSS style sheet			public/css/style.css
		- sass or less				resources/assets/sass/app.scss
		- config files				config/foo.php
		
	- Where can I find help?
		- php artisan
			- this will show you the help file
			
	- How do serve the pages or start the server?
		- php artisan serve
	- Tinker, allows you to make changes in your build via CLI like npm
		- php artisan tinker
			- check data, add data
	
	- Elixir, what is it?
		- Predefined mixin to perform common tasks or an API for defining basic Gulp tasks for your Laravel application.
		- it needs npm to run Gulp and finish the build
		- "gulp --production" will run the sass and minify
		- "gulp watch" to update automatically 

Make(ing)
	- Controllers
		- php artisan make:controller FooControllerName
	- migrations
		- php artisan make:migration FooNameOfFile
Setting up the DB
	- for sqlite
		- create folder and file
			- touch database/database.sqlite
		- change presets in .env & config/database.php or the migrations will fail.
Create migration
	- 
	- fail... file access error
		- check .env
			- DB_CONNECTION=sqlite  // defaults to mysql... must be change to use sqlite
		- correct config/database.php
			- 'database' => database_path('database.sqlite') // no ENV data
		- do not need to change sqlite dev default values for...
			- 	DB_DATABASE=homestead
				DB_USERNAME=homestead
				DB_PASSWORD=secret
		- might not need permissions changes
			- I made changes before correcting the other files
DB - Create tables...
	- php artisan
		- (use query builder) 
			- DB::table('cards')->insert(['title' => 'My New Card', 'created_at' => new DateTime, 'updated_at' => new DateTime]);
		- error at 07 10:33 ---- typo error... will cause this
			- Illuminate\Database\QueryException with message 'SQLSTATE[HY000]': General error: 1 table cards has no column name update_at (SQL: insert into "cards" ("title", "created_at", "update_at") values (foo bar))'	
			
============
Random errors while installing or running:
	- give the correct permissions to PHP and or the directories so Laravel can create a new project in Foo directory /var/www/html/foobar

	- add "php5-sqlite" if sqlite "can't find driver", should be included in PHP install, but isn't with *Ubuntu
		- sudo apt-get install php5-sqlite

serve the project/site with this stack
	- "php artisan serve" within the root directory
	

php artisan tinker
	- use to create new "card" adding to DB
		- DB::table('cards')->insert(['title' => 'My New Card', 'created_at' => new DateTime, 'updated_at' => new DateTime]);
		- DB::table('cards')->insert(['title' => 'My Second New Card', 'created_at' => new DateTime, 'updated_at' => new DateTime]);
	- query
		- DB::table('cards')->get();
		- DB::table('cards')->where('title', 'My New Card')->first();
	- delete
		- DB::table('cards')->where('title', 'My New Cards')->delete();

	note: be careful not to tab or escape out of Tinker into the normal CLI, Tinker and CLI look very similar and none of the DB commands will work the same in the CLI.

php artisan make:model Card  //Eloquent 

===
making relationships (wording)

problems
	- Breaking changes from version Laravel 5.0 -5.2
		 - "token mismatch exception"
		 	- work around for dev env tut 
		 		- edit App\Http\Middleware\VerifyCsrfToken
		 			- add pages that you want to bypass check... all = '*' or some =' foo/bar/row/*'

migrations and rolling back, refresh, 

note:

    - CLI  // list of commands, not a logical list
    	- php artisan // version, options, commands list
    	- php artisan help foo:bar  // get info on foo:bar

    	-	php artisan make:migration create_user_table --create=users
    			// creating a migration file, with some default values
    		php artisan migrate
    			// implement the migration you just created
    		php artisan migrate:refresh
    			// drop all data in DB and reimplement migration DB setup 
    		php artisan Schema::drop('users');

	- php artisan tinker
		- check User(s) in the DB
			- App\User::all();
		- check Note(s) in the DB
			- App\Note::all();
		- Create a new User the long way
			-	namespace App;
				$card = new Card;
				$card->title = 'My First Card';
				$card->save();

				$note = new Note;
				$note->user_id = 1;
				$note->body = 'The body of the note.';
				$card->addNote($note); // note data is printed to screen

				$user = new User;
				$user->username = 'FooName';
				$user->email = 'FooName@Bar.com';
				$user->password = bcrypt('FooPassword');
				$user->save();

				User::all(); // data for user printed to screen



			-   $user = new App\User; or 	$user = new User; if you are not in App
				$user->username = 'fooName';
				$user->email = 'fooName@fooemail.com';
				$user->password = bcrypt('fooPassword');
				$user->save();
				
			-	$note = new Note;
				$note->user_id = foo1;
				$note->body = 'Foo note';
				$card->addNote($note);


redo 10
	- error with showing data in cards/1 input field
	- possible DB schema error or naming error(s)
		- delete old migrations, create new ones, add user and notes

	- redid all DB data
	- might be problem with breaking change
	- consider restarting fresh and sprinting through.



===
current to 08
  - end of 7  ... data still showing wrong.  Is my data wrong or displayed wrong or both?
  - It was showing cached data.  It looks like I have more than one DB, cards made on different days with different names.
  - Serving DB and php artisan tinker DB show different
  - Data is now showing in web and CLI the same
  - add another card to match what the tut shows.
  	- done
	  
08
	- php artisan make:migration create_notes_table --create=notes
	- $cards->notes;  // this will get the relationship
	- @ 08 5:00 Tinker CLI not showing relationship for Card/Note correctly
		- $card = App\Card::first();
		- $card->notes;  // should fetch relationship
			- shows "[]" empty set?
			App\Note::all();
				- show data that is the same as his data.
			- maybe his method no longer works or I made an error.
	- $card->notes[0] // this fails... maybe the method notes is broken
	- added a new Note, so now we have a Note for both id 1 and 2.
	- working now
		- must first "$card = App\Card::first();"
		- then "$card->notes;"
	- About Tinker
		- remember to enter/exit it to refresh (I assume it could have data problems if you didn't).
	- watch the SQL queries - 08 @7:00?
		- this is a lesson that Laravel caches the SQL queries
		- DB::listen(function($query) { var_dump($query->sql); });
	- creating a Note all in one line
		- $card->notes()->create(['body' => 'The third note.']);
			- "MassAssignmentException", got to set properties for 'body'
- end 8... everything is working perfectly
- start 9
	- @ 6:59 - had to do the very silly "token mismatch exception" work around in "VerifyCsrfToken"
- end 9 - all working
- start 10
	- @9:49 - still perfect
	- @13:20 - still good post USER table creation
	- @14:21 - errors with DB refresh [drop/migrations]
		- error while refreshing migrations, typo... typo fixed
		- retried refreshing migration... errors
		- rollback migration
		- refresh migration... error
			- error from not having data in new/old tables???
			- added Card, Notes still exist???, Added One User
			???
		- refresh.. looks like create_cards_table works perfect on migration, but Cards and Users don't
		- fails to add User(s), but can add Cards and Notes.
		- how do I fix this?
		
	
	
		
	
			

  